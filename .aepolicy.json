{
  "version": "1.0",
  "policies": [
    {
      "action": "plan.add_step",
      "deny_if": {
        "step_name_contains": [
          "rm -rf",
          "sudo rm",
          "DROP TABLE",
          "DROP DATABASE",
          "DELETE FROM",
          "TRUNCATE",
          "curl | bash",
          "wget | sh",
          "eval(",
          "exec(",
          "__import__"
        ]
      },
      "reason": "Dangerous commands or patterns not allowed in plan steps"
    }
  ],
  "legacy": {
    "allow": {
      "commands": ["pytest", "npm", "pnpm", "yarn", "mvn", "gradle", "git"],
      "paths": ["src/**", "backend/**", "web/**", "tests/**"]
    },
    "deny": { "commands": ["docker login", "curl http://"] }
  }
}