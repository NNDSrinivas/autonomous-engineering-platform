{
  "$id": "https://navi.dev/schemas/budget-policy.json",
  "title": "NAVI Budget Policy",
  "description": "Multi-tenant budget governance schema with fail-closed validation",
  "type": "object",
  "additionalProperties": false,
  "required": ["version", "day_boundary", "units", "defaults"],
  "properties": {
    "version": {
      "type": "integer",
      "description": "Schema version for backward compatibility",
      "minimum": 1,
      "maximum": 1
    },
    "day_boundary": {
      "type": "string",
      "description": "Budget reset boundary (UTC required for Phase 4)",
      "enum": ["UTC"]
    },
    "units": {
      "type": "string",
      "description": "Budget unit of measurement (tokens recommended for accuracy)",
      "minLength": 1,
      "maxLength": 50
    },
    "defaults": {
      "type": "object",
      "description": "Global default budget limits (fallback for all scopes)",
      "additionalProperties": false,
      "required": ["per_day"],
      "properties": {
        "per_day": {
          "type": "integer",
          "description": "Default daily budget limit in specified units",
          "minimum": 0
        }
      }
    },
    "orgs": {
      "type": "object",
      "description": "Per-organization budget overrides (key: org_id)",
      "additionalProperties": {
        "type": "object",
        "additionalProperties": false,
        "required": ["per_day"],
        "properties": {
          "per_day": {
            "type": "integer",
            "description": "Daily budget limit for this organization",
            "minimum": 0
          },
          "tags": {
            "type": "array",
            "description": "Optional metadata tags for reporting",
            "items": {
              "type": "string"
            }
          }
        }
      }
    },
    "users": {
      "type": "object",
      "description": "Per-user budget overrides (key: user_id)",
      "additionalProperties": {
        "type": "object",
        "additionalProperties": false,
        "required": ["per_day"],
        "properties": {
          "per_day": {
            "type": "integer",
            "description": "Daily budget limit for this user",
            "minimum": 0
          }
        }
      }
    },
    "providers": {
      "type": "object",
      "description": "Per-provider budget limits (key: provider_id)",
      "additionalProperties": {
        "type": "object",
        "additionalProperties": false,
        "required": ["per_day"],
        "properties": {
          "per_day": {
            "type": "integer",
            "description": "Daily budget limit for this provider",
            "minimum": 0
          }
        }
      }
    },
    "models": {
      "type": "object",
      "description": "Per-model budget limits (key: model_id in vendor/model format)",
      "additionalProperties": {
        "type": "object",
        "additionalProperties": false,
        "required": ["per_day"],
        "properties": {
          "per_day": {
            "type": "integer",
            "description": "Daily budget limit for this specific model",
            "minimum": 0
          }
        }
      }
    }
  }
}
